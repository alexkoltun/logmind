input {
#	stdin { type => "manual_2" }
	file {
		type => "local_logs"
		charset => "CP1252"
		path => ["/var/log/*", "/var/log/**/*"]
		exclude => ["*.gz"]
		sincedb_path => "/usr/local/logmind/sixthsense/.local-logs-sdb"
	}
	
	file {
		charset => "CP1252"
		type => "auditlog"
		path => ["/var/log/audit/audit.log"]
		tags => ["audit-log"]
		sincedb_path => "/usr/local/logmind/sixthsense/.audit-logs-sdb"
	}
	
	tcp {
		port => 8751
		mode => "server"
		type => "wda"
		format => "json_event"
	}
	
	filter {
		mutate {
			replace => [ "TimeGenerated", "%{TimeGenerated}Z" ]
		}
		date {
			match => [ "TimeGenerated", "ISO8601" ]
		}
	}

}

output {
	redis { 
		host => "127.0.0.1" 
		data_type => "list" 
		key => "logmind" 
	}
}
